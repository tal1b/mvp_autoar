{% extends "base.html" %}

{% block title %}{{ 'Salaries' if is_manager else 'My Salaries' }} - Employee Management System{% endblock %}

{% block content %}
<div class="page-header">
    <h2>ðŸ’° {{ 'Salaries' if is_manager else 'My Salaries' }}</h2>
    {% if is_manager %}
    <div>
        <a href="{{ url_for('add_salary') }}" class="btn btn-primary">Add Salary</a>
        <a href="{{ url_for('export_data', data_type='salaries', format='csv') }}" class="btn btn-secondary">Export CSV</a>
        <a href="{{ url_for('export_data', data_type='salaries', format='excel') }}" class="btn btn-secondary">Export Excel</a>
    </div>
    {% endif %}
</div>

<div class="filters">
    <form method="GET" action="{{ url_for('salaries') }}" class="filter-form">
        {% if is_manager %}
        <div class="form-group">
            <select name="employee" class="form-control">
                <option value="">All Employees</option>
                {% for emp in employees %}
                <option value="{{ emp.id }}" {% if employee_filter|string == emp.id|string %}selected{% endif %}>
                    {{ emp.full_name }}
                </option>
                {% endfor %}
            </select>
        </div>
        {% endif %}
        <div class="form-group">
            <input type="month" name="period" value="{{ period_filter }}" class="form-control" placeholder="Period">
        </div>
        <button type="submit" class="btn btn-primary">Search</button>
        <a href="{{ url_for('salaries') }}" class="btn btn-secondary">Reset</a>
    </form>
</div>

{% if salaries %}
<div class="table-container">
    <table class="employees-table">
        <thead>
            <tr>
                <th>ID</th>
                {% if is_manager %}
                <th>Employee</th>
                {% endif %}
                <th>Type</th>
                <th>Amount</th>
                <th>Hourly Rate</th>
                <th>Period Start</th>
                <th>Period End</th>
                <th>Created</th>
            </tr>
        </thead>
        <tbody>
            {% for salary in salaries %}
            <tr>
                <td>{{ salary.id }}</td>
                {% if is_manager %}
                <td>{{ salary.employee_name }}</td>
                {% endif %}
                <td>{{ 'Fixed' if salary.salary_type == 'fixed' else 'Hourly' }}</td>
                <td>${{ "%.2f"|format(salary.amount) }}</td>
                <td>${{ "%.2f"|format(salary.hourly_rate) if salary.hourly_rate else '-' }}/hr</td>
                <td>{{ salary.period_start }}</td>
                <td>{{ salary.period_end }}</td>
                <td>{{ salary.created_at[:10] if salary.created_at else '-' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="empty-state">
    <p>ðŸ’° No salaries found.</p>
    {% if is_manager %}
    <a href="{{ url_for('add_salary') }}" class="btn btn-primary">Add First Salary</a>
    {% endif %}
</div>
{% endif %}
{% endblock %}
